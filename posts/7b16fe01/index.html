<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="打怪升级，游戏人生"><title>你不知道的rollup | SioCheung</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '05229ec683dcdbf3f2336800f1e4a337';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
  </script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">你不知道的rollup</h1><a id="logo" href="/."><span class="defualt">Sio</span><span class="vi-color">Cheung</span></a><p class="description">君子求诸己</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">你不知道的rollup</h1><div class="post-meta">Sep 18, 2019<span> | </span><span class="category"><a href="/categories/categories/">categories</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装"><span class="toc-number">1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置"><span class="toc-number">2.</span> <span class="toc-text">配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#配置文件配置"><span class="toc-number">2.1.</span> <span class="toc-text">配置文件配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CLI配置"><span class="toc-number">2.2.</span> <span class="toc-text">CLI配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#input"><span class="toc-number">2.3.</span> <span class="toc-text">input</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#output-globals"><span class="toc-number">2.4.</span> <span class="toc-text">output.globals</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#output-format"><span class="toc-number">2.5.</span> <span class="toc-text">output.format</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插件-plugins"><span class="toc-number">3.</span> <span class="toc-text">插件(plugins)</span></a></li></ol></div></div><div class="post-content"><p>简单总结打包工具选择：应用的打包选择webpack，模块和库的打包选择rollup更为合适。</p>
<p>rollup的打包小体积的代码速度更快，体积更小。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>全局安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install --global rollup</span></span><br></pre></td></tr></table></figure>
<p> 项目内安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save-dev rollup</span><br></pre></td></tr></table></figure>
<p>当然也可以使用<code>yarn</code>进行安装，安装方式和npm类似。</p>
<p>使用rollup有两种方式，<code>command line interface</code>或者<code>js api</code>，如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用配置文件</span></span><br><span class="line">$ rollup -c rollup.config.js</span><br><span class="line"><span class="comment"># 或者命令行参数</span></span><br><span class="line">$ rollup src/index.js --file dist/index.js --format umd --name soundbarCore</span><br></pre></td></tr></table></figure>
<p>命令行参数其实就是rollup的运行配置，告诉rollup如何进行运行，如入口文件，输出文件，打包输出格式以及名称等等。</p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>下面就研究下rollup的配置，整个rollup的了解就基本到位了。</p>
<p>官方文档的配置列表里，截取了满足绝大数场景常用的配置参数，下面列举配置文件和命令行常用的配置参数。其他更多参数也很少用，如果需要可以去官网查字典。</p>
<h4 id="配置文件配置"><a href="#配置文件配置" class="headerlink" title="配置文件配置"></a>配置文件配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  input, # 入口文件 类似webpack string | string [] | &#123; [entryName: string]: string &#125;</span><br><span class="line">  output:&#123;</span><br><span class="line">    dir, # 输出的包所在目录，当多个包生成时候是必要的</span><br><span class="line">    name, # 模块名可以代表你输出的模块 在iife/umd 打包类型下使用</span><br><span class="line">truetruefile, # 输出文件名，在只有一个包生成时候使用</span><br><span class="line">    format, # 打包类型，下面详解</span><br><span class="line">    globals, # 配合external使用全局变量，下面详解</span><br><span class="line">    assetFileNames,</span><br><span class="line">    chunkFileNames,</span><br><span class="line">    sourcemap</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins:[], # 强大的插件机制，下面详解</span><br><span class="line">  cache, # 高级用法</span><br><span class="line">  external, # 打包需要排除的文件、模块或者文件夹，第三方外部依赖(string | RegExp)[] | RegExp | string </span><br><span class="line">  treeshake, # 高级用法</span><br><span class="line">  watch:&#123;</span><br><span class="line">  	buildDelay,</span><br><span class="line">    chokidar,</span><br><span class="line">    clearScreen,</span><br><span class="line">    skipWrite,</span><br><span class="line">    exclude,</span><br><span class="line">    include</span><br><span class="line">true&#125; | <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置文件中的这些配置在命令行中基本都有对应的配置参数，往往缩写较为常见，如<code>-o</code> 等同于<code>file</code>，<code>-f</code>等同于<code>format</code>等等。如果在命令行中使用这些参数，这些参数的值优先级会高于配置文件<code>rollup.config.js</code>，即<strong>命令行参数会覆盖掉配置文件的相同配置项</strong>。</p>
<h4 id="CLI配置"><a href="#CLI配置" class="headerlink" title="CLI配置"></a>CLI配置</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">c, --config &lt;filename&gt;     指定配置文件，默认rollup.config.js</span></span><br><span class="line"><span class="ruby">-d, --dir &lt;dirname&gt;         chunks目录</span></span><br><span class="line"><span class="ruby">-e, --external &lt;ids&gt;        Comma-separate list of <span class="class"><span class="keyword">module</span> <span class="title">IDs</span> <span class="title">to</span> <span class="title">exclude</span></span></span></span><br><span class="line"><span class="ruby">-f, --format &lt;format&gt;       输出类型 (amd, cjs, es, iife, umd, system)</span></span><br><span class="line"><span class="ruby">-g, --globals &lt;pairs&gt;       Comma-separate list of <span class="string">`moduleID:Global`</span> pairs</span></span><br><span class="line"><span class="ruby">-i, --input &lt;filename&gt;      入口文件</span></span><br><span class="line"><span class="ruby">-m, --sourcemap             Generate sourcemap (<span class="string">`-m inline`</span> <span class="keyword">for</span> inline map)</span></span><br><span class="line"><span class="ruby">-n, --name &lt;name&gt;           输出类型选择UMD时，输出的模块名称</span></span><br><span class="line"><span class="ruby">-o, --file &lt;output&gt;         输出文件</span></span><br><span class="line"><span class="ruby">-p, --plugin &lt;plugin&gt;       指定使用的插件</span></span><br><span class="line"><span class="ruby">-v, --version               rollup版本号</span></span><br><span class="line"><span class="ruby">-w, --watch                 Watch files <span class="keyword">in</span> bundle <span class="keyword">and</span> rebuild on changes</span></span><br></pre></td></tr></table></figure>
<h4 id="input"><a href="#input" class="headerlink" title="input"></a>input</h4><p>Type:  <code>string | string [] | { [entryName: string]: string }</code></p>
<p>入口文件，也是必要配置之一，可以是字符串（单入口），也可以是数组（多入口），如果<code>output.file</code>没有设置那么会根据入口文件进行打包输出，输出名会依据<code>output.entryFileNames</code>进行设定。举个例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  ...,</span><br><span class="line">  <span class="comment">// input: 'src/main-a.js',</span></span><br><span class="line">  input: &#123;</span><br><span class="line">    a: <span class="string">'src/main-a.js'</span>,</span><br><span class="line">    <span class="string">'b/index'</span>: <span class="string">'src/main-b.js'</span> <span class="comment">//注意key值写法</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    ...,</span><br><span class="line">    entryFileNames: <span class="string">'entry-[name].js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>如果入口文件是字符串，那么output的<code>[name]</code>就是文件名，如果是对象<code>[name]</code>就是每一个子元素的属性。</p>
<p><code>entry-b</code>为一个文件夹，在没有指定<code>output.file</code>的情况下，上述配置将会按照<code>input</code>和<code>entryFileNames</code>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── entry-<span class="selector-tag">a</span>.js</span><br><span class="line">└── entry-b</span><br><span class="line">    └── index.js</span><br></pre></td></tr></table></figure>
<p>当使用<code>CLI</code>的时候，<code>--input</code>如果在首参位置可以省略，在之后每个入口值之前都需要加<code>--input</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ rollup --format es --input src/entry1.js --input src/entry2.js</span><br><span class="line"><span class="comment"># is equivalent to</span></span><br><span class="line">$ rollup src/entry1.js src/entry2.js --format es</span><br></pre></td></tr></table></figure>
<p>文件名中<strong>含有空格</strong>是合法的，但是记得要用引号括起来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rollup <span class="string">"src/entry 1.js"</span> <span class="string">"src/entry 2.js"</span> --format es</span><br></pre></td></tr></table></figure>
<h4 id="output-globals"><a href="#output-globals" class="headerlink" title="output.globals"></a>output.globals</h4><p>Type: <code>{ [id: string]: string } | ((id: string) =&gt; string)</code></p>
<p>外部依赖包的全局变量别名配置，尤其当使用<code>iife</code> <code>umd</code>打包类型，引入了外部依赖包，要告知rollup当前模块id对应的全局变量是什么，比如引入的<code>jquery</code>，rollup打包之后全局使用<code>$</code>等同于使用<code>jquery</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  ...,</span><br><span class="line">  external: [<span class="string">'jquery'</span>],</span><br><span class="line">  output: &#123;</span><br><span class="line">    format: <span class="string">'iife'</span>,</span><br><span class="line">    name: <span class="string">'MyBundle'</span>,</span><br><span class="line">    globals: &#123;</span><br><span class="line">      jquery: <span class="string">'$'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> MyBundle = (<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// code goes here '$' means jquery</span></span><br><span class="line">&#125;($));</span><br></pre></td></tr></table></figure>
<p>CLI中这么使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rollup  src/main.js -g jquery:$</span><br></pre></td></tr></table></figure>
<p>本地一些不想被打包的模块也可以使用<code>external</code>和<code>globals</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">'path'</span>;</span><br><span class="line"><span class="keyword">const</span> externalId = path.resolve( __dirname, <span class="string">'src/some-local-file-that-should-not-be-bundled.js'</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  ...,</span><br><span class="line">  external: [externalId],</span><br><span class="line">  output: &#123;</span><br><span class="line">    format: <span class="string">'iife'</span>,</span><br><span class="line">    name: <span class="string">'MyBundle'</span>,</span><br><span class="line">    globals: &#123;</span><br><span class="line">      [externalId]: <span class="string">'globalVariable'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="output-format"><a href="#output-format" class="headerlink" title="output.format"></a>output.format</h4><p>在不同场景中使用，采用<code>--format</code>参数进行包类型转换，<code>iife</code>适用于浏览器直接使用<code>script</code>标签引用，<code>cjs</code>是<code>commonjs</code>缩写适用于node环境的调用，使用<code>require(&#39;mypkg&#39;)</code>引入，<code>umd</code>兼容浏览器和node环境。</p>
<p>直接拉官网的列表，很简单无需翻译</p>
<ul>
<li><code>amd</code> – Asynchronous Module Definition, used with module loaders like RequireJS</li>
<li><code>cjs</code> – CommonJS, suitable for Node and other bundlers (alias: <code>commonjs</code>)</li>
<li><code>es</code> – Keep the bundle as an ES module file, suitable for other bundlers and inclusion as a <code>&lt;script type=module&gt;</code> tag in modern browsers (alias: <code>esm</code>, <code>module</code>)</li>
<li><code>iife</code> – A self-executing function, suitable for inclusion as a <code>&lt;script&gt;</code> tag. (If you want to create a bundle for your application, you probably want to use this.)</li>
<li><code>umd</code> – Universal Module Definition, works as <code>amd</code>, <code>cjs</code> and <code>iife</code> all in one</li>
<li><code>system</code> – Native format of the SystemJS loader (alias: <code>systemjs</code>)</li>
</ul>
<p><strong>在浏览器中使用</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> compile to a &lt;script&gt; containing a self-executing <span class="keyword">function</span> (<span class="string">'iife'</span>)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> rollup main.js --file bundle.js --format iife</span></span><br></pre></td></tr></table></figure>
<p><strong>在Nodejs中使用</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> compile to a CommonJS module (<span class="string">'cjs'</span>)</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> rollup main.js --file bundle.js --format cjs</span></span><br></pre></td></tr></table></figure>
<p><strong>兼容浏览器和Node.js使用场景</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> UMD format requires a bundle name</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> rollup main.js --file bundle.js --format umd --name <span class="string">"myBundle"</span></span></span><br></pre></td></tr></table></figure>
<h3 id="插件-plugins"><a href="#插件-plugins" class="headerlink" title="插件(plugins)"></a>插件(plugins)</h3><p>rollup和webpack不同之处在于，要使用好它的<code>plugin</code>，<strong>插件的作用是非常大的</strong>。</p>
<p>比如webpack中常见的<code>alias</code>，在rollup中需要使用<code>@rollup/plugin-alias</code>插件完成，babel的转换也是通过<code>@rollup/plugin-babel</code>完成的。错误的插件会被忽略。<strong>注意</strong>区分生产环境和开发环境的插件的使用，插件是可以影响打包速度的，如非生产环境就非必要使用压缩插件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">import</span> resolve <span class="keyword">from</span> <span class="string">'@rollup/plugin-node-resolve'</span>;</span><br><span class="line"><span class="keyword">import</span> commonjs <span class="keyword">from</span> <span class="string">'@rollup/plugin-commonjs'</span>;</span><br><span class="line"><span class="keyword">const</span> isProduction = process.env.NODE_ENV === <span class="string">'production'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (<span class="keyword">async</span> () =&gt; (&#123;</span><br><span class="line">  input: <span class="string">'main.js'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    resolve(),</span><br><span class="line">    commonjs(),</span><br><span class="line">    isProduction &amp;&amp; (<span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">'rollup-plugin-terser'</span>)).terser() <span class="comment">// 按需异步引入生产环境使用terser压缩</span></span><br><span class="line">  ],</span><br><span class="line">  output: &#123;</span><br><span class="line">    file: <span class="string">'bundle.js'</span>,</span><br><span class="line">    format: <span class="string">'cjs'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;))()</span><br></pre></td></tr></table></figure>
<p><strong>常用的插件列举一下</strong></p>
<p>处理node_modules里第三方模块，否则可以打包成功但是报<code>Unresolved dependencies</code>错误，且包中没有第三方依赖。<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@rollup/plugin-<span class="keyword">node</span><span class="title">-resolve</span></span><br></pre></td></tr></table></figure></p>
<p>将CommonJS 模块转换成 ES6，如果使用<code>resolve()</code>会对node_modules引入模块处理，如果没有此插件肯定报错。<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">rollup</span>/<span class="keyword">plugin</span>-<span class="keyword">commonjs</span></span><br></pre></td></tr></table></figure></p>
<p>可以使用别名，参考wenpack的别名使用<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">rollup</span>/<span class="keyword">plugin</span>-<span class="keyword">alias</span></span><br></pre></td></tr></table></figure></p>
<p>使用babel以及babel的配置<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">rollup</span>/<span class="keyword">plugin</span>-<span class="keyword">babel</span></span><br></pre></td></tr></table></figure></p>
<p>将json文件转换成ES6，例如在引用<code>package.json</code>获取版本号、包名称、作者信息等等时候必须加上此插件<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">rollup</span>/<span class="keyword">plugin</span>-<span class="keyword">json</span></span><br></pre></td></tr></table></figure></p>
<p>使用typescript<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">rollup</span>/<span class="keyword">plugin</span>-<span class="keyword">typescript</span></span><br></pre></td></tr></table></figure></p>
<p>官方其实是没有这些插件的列表的，但是需要的东西总能找出来，rollup现在绝大数的插件的<code>scope</code>都是<code>@rollup</code>，所以在<strong>npmjs上搜一下这个scope</strong>就能看到几乎所有的插件。</p>
<p><code>plugins</code>使用方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rollup.config.js</span></span><br><span class="line"><span class="keyword">import</span> resolve <span class="keyword">from</span> <span class="string">'@rollup/plugin-node-resolve'</span></span><br><span class="line"><span class="keyword">import</span> commonjs <span class="keyword">from</span> <span class="string">'@rollup/plugin-commonjs'</span></span><br><span class="line"><span class="keyword">import</span> alias <span class="keyword">from</span> <span class="string">'@rollup/plugin-alias'</span></span><br><span class="line"><span class="keyword">import</span> babel <span class="keyword">from</span> <span class="string">'@rollup/plugin-babel'</span></span><br><span class="line"><span class="keyword">import</span> &#123; terser &#125; <span class="keyword">from</span> <span class="string">'rollup-plugin-terser'</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">true...,</span><br><span class="line">  plugins: [</span><br><span class="line">    commonjs(),</span><br><span class="line">    resolve(),</span><br><span class="line">    terser(),</span><br><span class="line">    babel(&#123; <span class="attr">babelHelpers</span>: <span class="string">'bundled'</span> &#125;),</span><br><span class="line">    alias(&#123;</span><br><span class="line">      entries: [</span><br><span class="line">        &#123; <span class="attr">find</span>: <span class="string">'@core'</span>, <span class="attr">replacement</span>: path.resolve(__dirname, <span class="string">'src/core'</span>) &#125;,</span><br><span class="line">        &#123; <span class="attr">find</span>: <span class="string">'@lib'</span>, <span class="attr">replacement</span>: path.resolve(__dirname, <span class="string">'src/lib'</span>) &#125;,</span><br><span class="line">        &#123; <span class="attr">find</span>: <span class="string">'@config'</span>, <span class="attr">replacement</span>: path.resolve(__dirname, <span class="string">'src/config'</span>) &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>后面会专门开一篇研究一下如何手撸一个<strong>rollup custom plugin</strong></p>
<blockquote>
<p>原创内容，欢迎交流转载请注明出处</p>
</blockquote>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>theo</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/posts/7b16fe01/">https://joacycode.github.io/posts/7b16fe01/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>theoCheung@China</li></ul></div><br><div class="tags"><a href="/tags/tag/">tag</a></div><div class="post-nav"><a class="pre" href="/posts/e7485c24/">常见模块化规范研究记录</a><a class="next" href="/posts/ad3abf2b/">浏览器标签之间的通信</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget widget-info"><div class="widget-info"><a style="text-align:center"><img class="widget-info-photo" src="https://aszero.oss-cn-shanghai.aliyuncs.com/imgs/fangao_495x606.jpg" style="width:80px;height:80px;border-radius: 100%;"></a><p class="myname">SioCheung</p><p class="slogan">Zero to Hero</p></div></div><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/posts/a0e43f83/">DSL介绍和使用</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/15ddfa03/">你不知道的AST</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/97b701ae/">你不知道的babel</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e87e7952/">那一年前端招人的部分笔试题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/6b76c6f6/">shell编程来实现一些自动化-基础篇</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e7485c24/">常见模块化规范研究记录</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/7b16fe01/">你不知道的rollup</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ad3abf2b/">浏览器标签之间的通信</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/30ba4d06/">你不知道的yarn</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5ece973c/">我对于同步异步和阻塞非阻塞理解</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/categories/">categories</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/dotjs/">dotjs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/h5/">h5</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ts/">ts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/webpack/">webpack</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/windows/">windows</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/joacycode" title="github.com/joacycode" target="_blank">github.com/joacycode</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">SioCheung.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>